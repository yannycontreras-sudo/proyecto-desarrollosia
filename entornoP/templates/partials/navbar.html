{% load static %}

<nav class="navbar navbar-expand-lg" style="background:#2f63c8; padding: 0.6rem 2rem;">

    <!-- Logo + texto EDUSALUD UCN -->
    <a href="{% url 'core:home' %}" class="navbar-brand d-flex align-items-center mb-0">
        <img src="{% static 'img/Escudo-UCN-Full-blanco_trans.png' %}"
             alt="UCN"
             style="height: 40px;"
             class="me-2">
        <span class="text-white fw-bold" style="font-size: 1.3rem;">EDUSALUD UCN</span>
    </a>

    {% if user.is_authenticated %}
    <!-- Botón hamburguesa -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
            aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-between" id="mainNavbar">
        <ul class="navbar-nav mx-auto">

            <!-- Home -->
            <li class="nav-item">
                <a class="nav-link text-white" href="{% url 'core:home' %}">Home</a>
            </li>

            <!-- Cursos -->
            <li class="nav-item">
                <a class="nav-link text-white" href="{% url 'cursos:lista' %}">Cursos</a>
            </li>

            <!-- Mis cursos (solo alumno) -->
            {% if user.role == 'student' or user.role == 'alumno' %}
            <li class="nav-item">
                <a class="nav-link text-white" href="{% url 'cursos:mis_cursos' %}">Mis cursos</a>
            </li>
            {% endif %}

            <!-- Contacto con Crear Ticket adentro -->
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle text-white"
                   href="#"
                   id="contactDropdown"
                   role="button"
                   data-bs-toggle="dropdown"
                   aria-expanded="false">
                    Contacto
                </a>
                <ul class="dropdown-menu" aria-labelledby="contactDropdown">
                    <li>
                        <a class="dropdown-item" href="{% url 'tickets:crear_ticket' %}">
                            Crear ticket de soporte
                        </a>
                    </li>
                    <li>
                        <a class="dropdown-item" href="mailto:soporte@ucn.cl">
                            Email soporte
                        </a>
                    </li>
                </ul>
            </li>

        </ul>

        <!-- Botón login/logout -->
        <div class="d-flex">
            {% if user.is_authenticated and user.avatar and user.avatar.imagen %}
                <img src="{{ user.avatar.imagen.url }}"
                     alt="Avatar"
                     class="rounded-circle"
                     style="width: 32px; height: 32px; object-fit: cover; margin-right: 8px;">
            {% endif %}

            <a href="{% url 'gestiondeusuarios:logout' %}"
               class="btn btn-outline-light btn-sm">
                Cerrar sesión
            </a>
        </div>
    </div>
    {% endif %}
</nav>
